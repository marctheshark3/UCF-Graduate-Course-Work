source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
min.rss = which.min(reg.sum$rss)
min.rss
reg.sum = summary(regfit)
reg.sum$rss
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
library(leaps)
data.full <- data.frame(y = y, x = x)
regfit.full <- regsubsets(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10), data = data.full, nvmax = 10)
reg.summary <- summary(regfit.full)
par(mfrow = c(2, 2))
plot(reg.summary$cp, xlab = "Number of variables", ylab = "C_p", type = "l")
set.seed(1)
x <- rnorm(100)
eps <- rnorm(100)
b0 <- 2
b1 <- 3
b2 <- -1
b3 <- 0.5
y <- b0 + b1 * x + b2 * x^2 + b3 * x^3 + eps
library(leaps)
data.full <- data.frame(y = y, x = x)
regfit.full <- regsubsets(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10), data = data.full, nvmax = 10)
reg.summary <- summary(regfit.full)
par(mfrow = c(2, 2))
plot(reg.summary$cp, xlab = "Number of variables", ylab = "C_p", type = "l")
points(which.min(reg.summary$cp), reg.summary$cp[which.min(reg.summary$cp)], col = "red", cex = 2, pch = 20)
plot(reg.summary$bic, xlab = "Number of variables", ylab = "BIC", type = "l")
points(which.min(reg.summary$bic), reg.summary$bic[which.min(reg.summary$bic)], col = "red", cex = 2, pch = 20)
plot(reg.summary$adjr2, xlab = "Number of variables", ylab = "Adjusted R^2", type = "l")
points(which.max(reg.summary$adjr2), reg.summary$adjr2[which.max(reg.summary$adjr2)], col = "red", cex = 2, pch = 20)
b0 <- 5
b1 <- 4
b2 <- 35
b3 <- -5
y <- b0 + b1 * x + b2 * x^2 + b3 * x^3 + eps
library(leaps)
data.full <- data.frame(y = y, x = x)
regfit.full <- regsubsets(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10), data = data.full, nvmax = 10)
reg.summary <- summary(regfit.full)
par(mfrow = c(2, 2))
plot(reg.summary$cp, xlab = "Number of variables", ylab = "C_p", type = "l")
points(which.min(reg.summary$cp), reg.summary$cp[which.min(reg.summary$cp)], col = "red", cex = 2, pch = 20)
plot(reg.summary$bic, xlab = "Number of variables", ylab = "BIC", type = "l")
points(which.min(reg.summary$bic), reg.summary$bic[which.min(reg.summary$bic)], col = "red", cex = 2, pch = 20)
plot(reg.summary$adjr2, xlab = "Number of variables", ylab = "Adjusted R^2", type = "l")
points(which.max(reg.summary$adjr2), reg.summary$adjr2[which.max(reg.summary$adjr2)], col = "red", cex = 2, pch = 20)
library (leaps)
set.seed(1)
X <- rnorm(100)
e <- rnorm(100)
b0 <- 5
b1 <- 4
b2 <- 35
b3 <- -5
Y <- b0 + b1*X + b2*(X^2) + b3*(X^3)+e
data = data.frame( y = Y,x = X)
regfit = regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10)
reg.sum = summary(regfit)
par(mfrow = c(2,2))
plot(reg.sum$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
min.rss = which.min(reg.sum$rss)
points(min.rss, reg.sum$rss[min.rss], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
min.bic <- which.min(reg.sum$bic)
points(min.bic, reg.sum$bic[min.bic], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
max.adr2 <- which.max(reg.sum$adjr2)
points(max.adr2, reg.sum$adjr2[max.adr2], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
min.cp = which.min(reg.sum$cp)
points(min.cp, reg.sum$cp[min.cp], col = 'red' , cex = 2 , pch = 20)
p = which.min(reg.summary$bic)
p
set.seed(1)
X <- rnorm(100)
e <- rnorm(100)
b0 <- 5
b1 <- 4
b2 <- 35
b3 <- -5
Y <- b0 + b1*X + b2*(X^2) + b3*(X^3)+e
data <- data.frame( y = Y,x = X)
regfit <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10)
reg.sum <- summary(regfit)
par(mfrow = c(2,2))
plot(reg.sum$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
min.rss = which.min(reg.sum$rss)
points(min.rss, reg.sum$rss[min.rss], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
min.bic <- which.min(reg.sum$bic)
points(min.bic, reg.sum$bic[min.bic], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
max.adr2 <- which.max(reg.sum$adjr2)
points(max.adr2, reg.sum$adjr2[max.adr2], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
min.cp = which.min(reg.sum$cp)
points(min.cp, reg.sum$cp[min.cp], col = 'red' , cex = 2 , pch = 20)
set.seed(1)
reg.sum <- summary(regfit)
par(mfrow = c(2,2))
plot(reg.sum$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
min.rss <- which.min(reg.sum$rss)
points(min.rss, reg.sum$rss[min.rss], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
min.bic <- which.min(reg.sum$bic)
points(min.bic, reg.sum$bic[min.bic], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
max.adr2 <- which.max(reg.sum$adjr2)
points(max.adr2, reg.sum$adjr2[max.adr2], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
min.cp <- which.min(reg.sum$cp)
points(min.cp, reg.sum$cp[min.cp], col = 'red' , cex = 2 , pch = 20)
set.seed(1)
x <- rnorm(100)
eps <- rnorm(100)
b0 <- 5
b1 <- 4
b2 <- 35
b3 <- -5
y <- b0 + b1 * x + b2 * x^2 + b3 * x^3 + eps
library(leaps)
data.full <- data.frame(y = y, x = x)
regfit.full <- regsubsets(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10), data = data.full, nvmax = 10)
reg.summary <- summary(regfit.full)
par(mfrow = c(2, 2))
plot(reg.summary$cp, xlab = "Number of variables", ylab = "C_p", type = "l")
points(which.min(reg.summary$cp), reg.summary$cp[which.min(reg.summary$cp)], col = "red", cex = 2, pch = 20)
plot(reg.summary$bic, xlab = "Number of variables", ylab = "BIC", type = "l")
p = which.min(reg.summary$bic)
points(which.min(reg.summary$bic), reg.summary$bic[which.min(reg.summary$bic)], col = "red", cex = 2, pch = 20)
plot(reg.summary$adjr2, xlab = "Number of variables", ylab = "Adjusted R^2", type = "l")
points(which.max(reg.summary$adjr2), reg.summary$adjr2[which.max(reg.summary$adjr2)], col = "red", cex = 2, pch = 20)
set.seed(1)
x <- rnorm(100)
eps <- rnorm(100)
b0 <- 5
b1 <- 4
b2 <- 35
b3 <- -5
y <- b0 + b1 * x + b2 * x^2 + b3 * x^3 + eps
library(leaps)
data.full <- data.frame(y = y, x = x)
regfit.full <- regsubsets(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10), data = data.full, nvmax = 10)
reg.summary <- summary(regfit.full)
par(mfrow = c(2, 2))
plot(reg.summary$cp, xlab = "Number of variables", ylab = "C_p", type = "l")
points(which.min(reg.summary$cp), reg.summary$cp[which.min(reg.summary$cp)], col = "red", cex = 2, pch = 20)
plot(reg.summary$bic, xlab = "Number of variables", ylab = "BIC", type = "l")
p = which.min(reg.summary$bic)
points(which.min(reg.summary$bic), reg.summary$bic[which.min(reg.summary$bic)], col = "red", cex = 2, pch = 20)
plot(reg.summary$adjr2, xlab = "Number of variables", ylab = "Adjusted R^2", type = "l")
points(which.max(reg.summary$adjr2), reg.summary$adjr2[which.max(reg.summary$adjr2)], col = "red", cex = 2, pch = 20)
p = which.min(reg.summary$adjr2)
p
p = which.max(reg.summary$adjr2)
p
library (leaps)
set.seed(1)
X <- rnorm(100)
e <- rnorm(100)
b0 <- 5
b1 <- 4
b2 <- 35
b3 <- -5
Y <- b0 + b1*X + b2*(X^2) + b3*(X^3)+e
data <- data.frame( y = Y,x = X)
regfit <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10)
reg.sum <- summary(regfit)
par(mfrow = c(2,2))
plot(reg.sum$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
min.rss <- which.min(reg.sum$rss)
points(min.rss, reg.sum$rss[min.rss], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
min.bic <- which.min(reg.sum$bic)
points(min.bic, reg.sum$bic[min.bic], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
max.adr2 <- which.max(reg.sum$adjr2)
points(max.adr2, reg.sum$adjr2[max.adr2], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
min.cp <- which.min(reg.sum$cp)
points(min.cp, reg.sum$cp[min.cp], col = 'red' , cex = 2 , pch = 20)
set.seed(1)
coef(regfit,min.bic)
regfit <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10 , method = 'forward')
reg.sum <- summary(regfit)
par(mfrow = c(2,2))
plot(reg.sum$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
min.rss <- which.min(reg.sum$rss)
points(min.rss, reg.sum$rss[min.rss], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
min.bic <- which.min(reg.sum$bic)
points(min.bic, reg.sum$bic[min.bic], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
max.adr2 <- which.max(reg.sum$adjr2)
points(max.adr2, reg.sum$adjr2[max.adr2], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
min.cp <- which.min(reg.sum$cp)
points(min.cp, reg.sum$cp[min.cp], col = 'red' , cex = 2 , pch = 20)
reg.sum <- summary(regfit)
reg.sum
coef(regfit,min.bic)
regfit.fwd <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10 , method = 'forward')
reg.sum.fwd <- summary(regfit.fwd)
par(mfrow = c(2,2))
plot(reg.sum.fwd$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
min.rss <- which.min(reg.sum.fwd$rss)
points(min.rss, reg.sum.fwd$rss[min.rss], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.fwd$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
min.bic <- which.min(reg.sum.fwd$bic)
points(min.bic, reg.sum.fwd$bic[min.bic], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.fwd$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
max.adr2 <- which.max(reg.sum.fwd$adjr2)
points(max.adr2, reg.sum.fwd$adjr2[max.adr2], col = 'red' , cex = 2 , pch = 20)
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
coef(regfit,min.cp)
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
regfit.bwd <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10 , method = 'backward')
reg.sum.bwd <- summary(regfit.fwd)
par(mfrow = c(2,2))
plot(reg.sum.bwd$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
min.rss <- which.min(reg.sum.bwd$rss)
points(min.rss, reg.sum.bwd$rss[min.rss], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.bwd$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
min.bic <- which.min(reg.sum.bwd$bic)
points(min.bic, reg.sum.bwd$bic[min.bic], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.bwd$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
max.adr2 <- which.max(reg.sum.bwd$adjr2)
points(max.adr2, reg.sum.bwd$adjr2[max.adr2], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.bwd$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
min.cp <- which.min(reg.sum.bwd$cp)
points(min.cp, reg.sum.bwd$cp[min.cp], col = 'red' , cex = 2 , pch = 20)
mtext('PART C: Backwards', side = 3 , line = -2, outer = T)
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
coef(regfit.fwd,min.cp)
coef(regfit,min.bic)
#the number of variable that are chosen are the same for forward
coef(regfit.bwd,min.cp)
coef(regfit,min.bic)
coef(regfit.fwd,min.bic)
#the number of variable that are chosen are the same for forward
coef(regfit.bwd,min.bic)
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
library (leaps)
set.seed(333)
X <- rnorm(100)
e <- rnorm(100)
b0 <- 5
b1 <- 4
b2 <- 35
b3 <- -5
Y <- b0 + b1*X + b2*(X^2) + b3*(X^3)+e
data <- data.frame( y = Y,x = X)
regfit <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10)
reg.sum <- summary(regfit)
par(mfrow = c(2,2))
plot(reg.sum$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
points(which.min(reg.sum$rss), reg.sum$rss[which.min(reg.sum$rss)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
points( which.min(reg.sum$bic), reg.sum$bic[ which.min(reg.sum$bic)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
points(which.max(reg.sum$adjr2), reg.sum$adjr2[which.max(reg.sum$adjr2)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
min.cp <- which.min(reg.sum$cp)
points(min.cp, reg.sum$cp[min.cp], col = 'red' , cex = 2 , pch = 20)
mtext('PART B: Best Subset Selection', side = 3 , line = -2, outer = T)
coef(regfit, which.min(reg.sum$cp))
regfit.fwd <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10 , method = 'forward')
reg.sum.fwd <- summary(regfit.fwd)
par(mfrow = c(2,2))
plot(reg.sum.fwd$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
points(which.min(reg.sum.fwd$rss), reg.sum.fwd$rss[which.min(reg.sum.fwd$rss)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.fwd$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
points(which.min(reg.sum.fwd$bic), reg.sum.fwd$bic[which.min(reg.sum.fwd$bic)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.fwd$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
points(which.max(reg.sum.fwd$adjr2), reg.sum.fwd$adjr2[which.max(reg.sum.fwd$adjr2)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.fwd$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
points(which.min(reg.sum.fwd$cp), reg.sum.fwd$cp[which.min(reg.sum.fwd$cp)], col = 'red' , cex = 2 , pch = 20)
mtext('PART C: forward', side = 3 , line = -2, outer = T)
coef(regfit.fwd, which.min(reg.sum.fwd$cp))
regfit.bwd <- regsubsets(Y ~ X + I(X^2) + I(X^3) + I(X^4) + I(X^5) + I(X^6) + I(X^7) + I(X^8) + I(X^9) + I(X^10), data = data, nvmax = 10 , method = 'backward')
reg.sum.bwd <- summary(regfit.bwd)
par(mfrow = c(2,2))
plot(reg.sum.bwd$rss, xlab = ' Number of Variables' , ylab = 'RSS', type = "l")
points( which.min(reg.sum.bwd$rss), reg.sum.bwd$rss[ which.min(reg.sum.bwd$rss)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.bwd$bic, xlab = ' Number of Variables' , ylab = 'BIC', type = 'l')
points(which.min(reg.sum.bwd$bic), reg.sum.bwd$bic[which.min(reg.sum.bwd$bic)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.bwd$adjr2, xlab = ' Number of Variables' , ylab = 'Adjusted R2', type = 'l')
points(which.max(reg.sum.bwd$adjr2), reg.sum.bwd$adjr2[which.max(reg.sum.bwd$adjr2)], col = 'red' , cex = 2 , pch = 20)
plot(reg.sum.bwd$cp, xlab = ' Number of Variables' , ylab = 'Cp', type = 'l')
points( which.min(reg.sum.bwd$cp), reg.sum.bwd$cp[ which.min(reg.sum.bwd$cp)], col = 'red' , cex = 2 , pch = 20)
mtext('PART C: Backwards', side = 3 , line = -2, outer = T)
#the number of variable that are chosen are the same for forward
coef(regfit.bwd, which.min(reg.sum.bwd$cp))
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
# the number of variables for each value are 10 RSS, 3 BIC, 7 Adjusted R^2, 3 Cp
coef(regfit, which.min(reg.sum$cp))
coef(regfit.fwd, which.min(reg.sum.fwd$cp))
#the number of variable that are chosen are the same for forward
coef(regfit.bwd, which.min(reg.sum.bwd$cp))
source('~/Documents/MODELING AND SIMULATION/Data Mining Methodology/HW 3/HW3.R')
